language: node_js
node_js: 8

script:
  - if [ "$TRAVIS_BRANCH" = "master" ]; then npm run build:next; fi
  - if [ "$TRAVIS_BRANCH" = "prod" ]; then npm run build; fi
  - cd dist

deploy:
  - provider: script
  script: curl -T ./dist -u "$FTP_USER:$FTP_PASSWORD" ftps://waws-prod-db3-043.ftp.azurewebsites.windows.net
  on:
    branch: prod
  - provider: npm
    tag: latest
    all_branches: true
    skip_cleanup: true
    on:
      branch: prod
    email: $NPM_EMAIL
    api_key: $NPM_TOKEN
  - provider: npm
    tag: next
    on:
      branch: master
    all_branches: true
    skip_cleanup: true
    email: $NPM_EMAIL
    api_key: $NPM_TOKEN
